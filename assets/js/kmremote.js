function reset_form(e){$("#panel-"+e).find("form").get(0).reset(),$("#panel-"+e).find('input[type="hidden"]').each(function(){$(this).val($(this).attr("data-default"));var e=$(this).parent().find(".preview");e.css({backgroundColor:""});var a=e.find("i");a.length?a.removeClass():e.html("")}),$("#widget-view").find("input").first().prop("checked",!0),$(".widget-view-icon").show(),$(".widget-view-title,.widget-view-both").hide(),$("#widget-view-both-position").find("input").prop("checked",!1),$("#action-listen-app,#action-listen-path").removeClass("active"),$("#switch-on-finder").hide(),$("#panel-"+e).find(".content").scrollTop(0)}function open_panel(e){$("#panel-"+e).addClass("open"),PANEL=e}function close_panel(e){$("#panel-"+e).removeClass("open"),PANEL=""}function get_macro_name(e){var a=$(".picker-action").find('[data-value="'+e+'"]');return a.length?a.html():"<i>macro not found</i>"}function makeGrid(e){$(".board").find(".grid").html("");for(var a=$(window).width(),t=$(window).height(),i=a-24,n=t-28,o=Math.ceil(i/20),d=Math.ceil(n/20),r=1,c=$("<div>");r<=nItemH;){for(var s=1;s<=nItemW;){var l=$("<div>");l.addClass("grid-unit"),l.attr("data-row",r),l.attr("data-col",s),r<3&&s>=nItemW-1&&l.addClass("hidden"),c.append(l),s++}r++}e.find(".grid").html(c.html())}function getCurrentMacInfos(){return("run"!=MODE||AUTOSWITCH)&&("edit"!=MODE||ListenApp||ListenPath)?void $.ajax({data:{action:"getcurrentmacinfos"},success:function(e){if("run"==MODE&&AUTOSWITCH){var a={};a.board_id=parseInt($(".board.active").attr("id").split("b")[1],10);var t=BOARDS(a).first();if("Finder"==e.app)if(t.board_switch_on_app==e.app&&t.board_switch_on_path==e.path);else{var a={};a.board_switch_on_app=e.app,a.board_switch_on_path=e.path;var i=BOARDS(a).first();if(i)activate_board(i);else{var a={};a.board_switch_on_app=e.app,a.board_switch_on_path="";var i=BOARDS(a).first();i&&activate_board(i)}}else if(t.board_switch_on_app!=e.app){var a={};a.board_switch_on_app=e.app,i=BOARDS(a).first(),i&&activate_board(i)}}"edit"==MODE&&"board"==PANEL&&(ListenApp&&$('input[name="board_switch_on_app"]').val(e.app),ListenPath&&$('input[name="board_switch_on_path"]').val(e.path)),activate_check_mac_infos()}}):void activate_check_mac_infos()}function activate_check_mac_infos(){clearTimeout(checkMacInfosTimeout),checkMacInfosTimeout=setTimeout(getCurrentMacInfos,ListenDelay)}function desactivate_check_mac_infos(){clearTimeout(checkMacInfosTimeout)}function menu_toggle(){$("#top-menu-panel").hasClass("open")?menu_close():menu_open()}function menu_open(){$("#top-menu-panel").addClass("open")}function menu_close(){$("#top-menu-panel").removeClass("open")}function toggle_auto_switch_boards(){$(this).is(":checked")?auto_switch_boards_on():auto_switch_boards_off()}function auto_switch_boards_on(){AUTOSWITCH=!0,"toggle_auto_switch_boards"!=arguments.callee.caller.name&&$("#action-dynamic-board-witch-toggle").attr("checked",!0)}function auto_switch_boards_off(){AUTOSWITCH=!1,"toggle_auto_switch_boards"!=arguments.callee.caller.name&&$("#action-dynamic-board-witch-toggle").attr("checked",!1)}function toggle_mode(e){"run"==e.data.mode&&activate_mode_run(),"edit"==e.data.mode&&activate_mode_edition()}function activate_mode_edition(){MODE="edit",$("#top-menu-panel").find(".inner").css({paddingTop:margeH+254+40+6}),$("body").removeClass("mode-run").addClass("mode-edit"),makeGrid($(".board.active"))}function activate_mode_run(){MODE="run",$("#top-menu-panel").find(".inner").css({paddingTop:margeH+167+40+6}),$(".widget.selected").removeClass("selected"),$(".board").find(".grid").html(""),$("body").removeClass("mode-edit").addClass("mode-run")}function new_board(){init_new_board()}function edit_board(){populate_board_form()}function init_delete_board_from_manager(){board2Delete=$(this).attr("data-id"),$("#confirm-delete-board").addClass("open")}function init_delete_board_current(){board2Delete=$(".board.active").attr("id").split("b")[1],$("#confirm-delete-board").addClass("open")}function cancel_delete_board(){board2Delete="",$("#confirm-delete-board").removeClass("open")}function confirm_delete_board(){delete_board(board2Delete),board2Delete="",$("#confirm-delete-board").removeClass("open")}function board_manager_new_board(e,a){var t=$("<div>");t.addClass("item"),t.attr("data-id",e.board_id),t.html(e.board_title),a&&t.addClass("active");var i=$("#boards-manager").find('[data-id="'+e.board_id+'"]');if(i.length)i.html(e.board_title);else{var n=$("#boards-manager").find(".item"),o=!1;if(n.length){var o=!1;$("#boards-manager").find(".item").each(function(){if(!o){$(this).html()>e.board_title&&(t.insertBefore($(this)),o=!0)}})}o||$("#boards-manager").find(".section-content").append(t)}}function board_manager_activate_board(){if(!$(this).hasClass("active")){activate_board($(this).attr("data-id"))}}function save_widget(){var e=!!arguments.length&&arguments[0],a=$('form[name="widget"]').serialize();$.ajax({data:a,success:function(a){a.widget_id=parseInt(a.widget_id,10);var t={};t.widget_id=a.widget_id,WIDGETS(t).first()?WIDGETS(t).update(a):WIDGETS.insert(a),build_widget(a,!0),e&&window[e]()}})}function build_widget(e,a){var t=$("#w"+e.widget_id);if(!t.length){var i=20*parseInt(e.widget_sR,10)-20,n=20*parseInt(e.widget_sC,10)-20,o=20*(parseInt(e.widget_eC,10)-parseInt(e.widget_sC,10)+1),d=20*(parseInt(e.widget_eR,10)-parseInt(e.widget_sR,10)+1),r=$("<div>");r.attr("id","w"+e.widget_id),r.addClass("widget"),a&&r.addClass("selected"),r.css({top:i,left:n,width:o,height:d});var c=$("<div>");c.addClass("handler"),c.addClass("handler-move"),r.append(c);var s=$("<div>");s.addClass("resizer"),s.addClass("resizer-top"),s.addClass("ui-resizable-handle"),s.addClass("ui-resizable-n"),r.append(s);var l=$("<div>");l.addClass("resizer"),l.addClass("resizer-right"),l.addClass("ui-resizable-handle"),l.addClass("ui-resizable-e"),r.append(l);var p=$("<div>");p.addClass("resizer"),p.addClass("resizer-bottom"),p.addClass("ui-resizable-handle"),p.addClass("ui-resizable-s"),r.append(p);var _=$("<div>");_.addClass("resizer"),_.addClass("resizer-left"),_.addClass("ui-resizable-handle"),_.addClass("ui-resizable-w"),r.append(_);var u=$("<div>");u.addClass("in");var f=$("<div>");f.addClass("title"),u.append(f);var v=$("<div>");v.addClass("icon"),u.append(v),r.append(u),t=r.appendTo($("#b"+e.board_id)),t.resizable({containment:"parent",grid:[20,20],handles:{n:".resizer-top",e:".resizer-right",s:".resizer-bottom",w:".resizer-left"},minWidth:40,minHeight:40,resize:function(e,a){},stop:function(e,a){var t=parseInt(a.element.attr("id").split("w")[1],10),i={};i.widget_id=t;var n=WIDGETS(i).first(),o=""+(parseInt(n.widget_sR,10)-(a.originalPosition.top-a.position.top)/20),d=""+(parseInt(n.widget_sC,10)-(a.originalPosition.left-a.position.left)/20),r=""+(parseInt(n.widget_eR,10)-(a.originalSize.height-a.size.height)/20),c=""+(parseInt(n.widget_eC,10)-(a.originalSize.width-a.size.width)/20),s=WIDGETS(i).update({widget_sR:o,widget_sC:d,widget_eR:r,widget_eC:c}).first();s.action="savewidget",$.ajax({data:s,success:function(e){}})}}),t.draggable({containment:"parent",grid:[20,20],handle:".handler-move",drag:function(e,a){},stop:function(e,a){var t=parseInt(a.helper.attr("id").split("w")[1],10),i={};i.widget_id=t;var n=WIDGETS(i).first(),o=""+(a.position.top/20+1),d=""+(a.position.left/20+1),r=""+(parseInt(o,10)+(parseInt(n.widget_eR,10)-parseInt(n.widget_sR,10))),c=""+(parseInt(d,10)+(parseInt(n.widget_eC,10)-parseInt(n.widget_sC,10))),s=WIDGETS(i).update({widget_sR:o,widget_sC:d,widget_eR:r,widget_eC:c}).first();s.action="savewidget",$.ajax({data:s,success:function(e){}})}})}t.removeClass("view-icon view-title view-both"),t.addClass(e.widget_view),t.removeClass("left right above below"),"view-both"==e.widget_view&&""!=e.widget_view_both_position&&t.addClass(e.widget_view_both_position);var h=t.find(".title");h.html(e.widget_title);var g=e.widget_text_color||"000000";h.css({color:"#"+g});var m=t.find(".icon"),w=e.widget_icon_color||"000000";m.css({color:"#"+w}),m.removeClass().addClass("icon").addClass(e.widget_icon);var b=e.widget_background_color||"ffffff";t.css({backgroundColor:"#"+b})}function delete_widget(e){var a=!!arguments.length&&arguments[1],t={action:"deletewidget",pid:e};$.ajax({data:t,success:function(a){var t={};t.widget_id=e;var i=WIDGETS(t).remove();$("#w"+e).addClass("deleted"),setTimeout(function(){$("#w"+e).remove()},300)}}),a&&window[a]()}function edit_widget(){populate_widget_form()}function focus_widget(){if("edit"==MODE)select_widget($(this));else{var e={};e.widget_id=parseInt($(this).attr("id").split("w")[1],10);var a=WIDGETS(e).first(),t="";a&&(a.widget_title&&(t='<div class="title">'+a.widget_title+"</div>"),a.widget_action&&(t+='<div class="macro">Launch : <span>'+get_macro_name(a.widget_action)+"</span></div>"),a.widget_note&&(t+='<div class="note">'+a.widget_note+"</div>")),$(this).tooltipster({theme:"tooltipster-kmr",debug:!1,distance:2,contentAsHTML:!0,content:t,functionAfter:function(e,a){e.destroy()}}).tooltipster("open")}}function select_widget(e){e.parent().find(".selected").removeClass("selected"),e.addClass("selected")}function deselect_widget(){$(this).removeClass("selected")}function do_widget_macro(){if("run"==MODE){var e=parseInt($(this).attr("id").split("w")[1],10),a={};a.widget_id=e;var t=WIDGETS(a).first();if(t&&t.widget_action){var i={};i.action="launchmacro",i.macro=t.widget_action,$.ajax({data:i,success:function(e){}})}}}function save_board(){var e=!!arguments.length&&arguments[0],a=$('form[name="board"]').serialize();$.ajax({data:a,success:function(a){a.board_id=parseInt(a.board_id,10);var t={};t.board_id=a.board_id,BOARDS(t).first()?BOARDS(t).update(a):BOARDS.insert(a),build_board(a),board_manager_new_board(a,!1),activate_board(a.board_id),e&&window[e]()}})}function build_board(e){var a=$("#b"+e.board_id);if(!a.length){var t=$("<div>");t.attr("id","b"+e.board_id),t.addClass("board"),t.css({top:margeH,bottom:margeH,left:margeW,right:margeW});var i=$("<div>");i.addClass("grid"),t.append(i);var a=t.appendTo($("#boards"))}if(e.board_background_color){tinycolor(e.board_background_color).getBrightness()>200?a.addClass("bright"):a.removeClass("bright")}else a.addClass("bright")}function delete_board(e){$.ajax({data:{action:"deleteboard",pid:e},success:function(a){var t=$("#b".boardid),i={};if(i.board_id=parseInt(e,10),BOARDS(i).remove(),WIDGETS(i).remove(),$("#boards-manager").find('[data-id="'+e+'"]').remove(),t.hasClass("active")){var n="",o=t.prev(".board");if(o.length)n=o.attr("id").split("b")[1];else{t.next(".board").length&&(n=o.attr("id").split("b")[1])}n&&activate_board(n)}t.remove()}})}function activate_board(e){var a;if("object"==typeof e)a=e;else{var t={};t.board_id=parseInt(e,10),a=BOARDS(t).first()}var i="ffffff";i=a.board_background_color||"ffffff",$("#boards").css({backgroundColor:"#"+i}),$("#boards").find(".active").removeClass("active"),$("#b"+a.board_id).addClass("active"),"edit"==MODE&&makeGrid($("#b"+a.board_id)),$("#boards-manager").find(".active").removeClass("active"),$("#boards-manager").find('[data-id="'+a.board_id+'"]').addClass("active")}function populate_widget_form(){reset_form_widget();var e={};e.widget_id=parseInt($(".widget.selected").attr("id").split("w")[1],10);var a=WIDGETS(e).first();a&&($.each(a,function(e,a){var t=$('[name="'+e+'"]');if(t.length){var i=t.get(0).tagname;"radio"!=t.attr("type")?t.val(a):(t.attr("checked",!1),t.filter(function(){return $(this).val()==a}).attr("checked",!0))}}),$('form[name="widget"]').find(".input-color").each(function(){var e=$(this).find("input").val();$(this).find(".preview").css({backgroundColor:"#"+e})}),$('form[name="widget"]').find(".input-icon").each(function(){var e=$(this).find("input").val();$(this).find(".preview i").removeClass().addClass(e)}),$('form[name="widget"]').find(".input-action").each(function(){var e=$(this).find("input").val(),a="";e&&(a=get_macro_name(e)),$(this).find(".preview").html(a)}),widget_view_option(),panel_widget_open())}function init_new_widget(e,a,t,i){reset_form_widget(),$(".widget.selected").removeClass("selected");var n=$("#panel-widget").find("form"),o=$(".board.active").attr("id").split("b")[1];n.find('input[name="board_id"]').val(o),n.find('input[name="widget_sC"]').val(e),n.find('input[name="widget_sR"]').val(a),n.find('input[name="widget_eC"]').val(t),n.find('input[name="widget_eR"]').val(i),panel_widget_open()}function reset_form_widget(){reset_form("widget")}function panel_widget_open(){open_panel("widget")}function panel_widget_close(){$(".grid-unit").removeClass("on"),close_panel("widget")}function panel_widget_cancel(){panel_widget_close()}function widget_view_option(){switch($('input[name="widget_view"]:checked').val()){case"view-icon":$(".widget-view-icon").show(),$(".widget-view-title").hide(),$(".widget-view-both").hide();break;case"view-title":$(".widget-view-icon").hide(),$(".widget-view-title").show(),$(".widget-view-both").hide();break;case"view-both":$(".widget-view-icon").show(),$(".widget-view-title").show(),$(".widget-view-both").show();break}}function panel_save_widget(){save_widget("panel_widget_close")}function panel_delete_widget(){delete_widget($('input[name="widget_id"]').val(),"panel_widget_close")}function populate_board_form(){reset_form_board();var e={};e.board_id=parseInt($(".board.active").attr("id").split("b")[1],10);var a=BOARDS(e).first();a&&($.each(a,function(e,a){$('[name="'+e+'"]').val(a)}),$('form[name="board"]').find(".input-color").each(function(){var e=$(this).find("input").val();$(this).find(".preview").css({backgroundColor:"#"+e})}),$('form[name="board"]').find(".input-icon").each(function(){var e=$(this).find("input").val();$(this).find(".preview i").removeClass().addClass(e)}),"Finder"==a.board_switch_on_app&&$("#switch-on-finder").show(),panel_board_open())}function panel_board_open(){$("#top-menu-panel").removeClass("open"),open_panel("board")}function panel_board_close(){$("#top-menu-panel").removeClass("open"),close_panel("board")}function panel_board_cancel(){panel_board_close()}function panel_board_save(){save_board("panel_board_close")}function new_board(){init_new_board()}function init_new_board(){reset_form_board(),panel_board_open()}function reset_form_board(){reset_form("board")}function toggle_listen_app(){if($(this).hasClass("active")){$(this).removeClass("active"),ListenApp=!1;"Finder"==$(this).prev("input").val()?($("#switch-on-finder").show(),$('input[name="action-listen-path"]').val("")):$("#switch-on-finder").show()}else $(this).addClass("active"),ListenApp=!0}function toggle_listen_path(){$(this).hasClass("active")?($(this).removeClass("active"),ListenPath=!1):($(this).addClass("active"),ListenPath=!0)}function picker_color_open(){colorInput=$(this).parent().find("input"),actualColor=colorInput.val();var e=$(".picker-color").clone(!0);actualColor&&e.find('[data-value="'+actualColor+'"]').addClass("selected"),$("#panel-"+PANEL).find(".picker").append(e).addClass("open")}function picker_color_close(){colorInput="",actualColor="",selectedColor="",$("#panel-"+PANEL).find(".picker").html("").removeClass("open")}function picker_color_save(){selectedColor&&selectedColor!=actualColor&&(colorInput.val(selectedColor),colorInput.parent().find(".preview").css({backgroundColor:"#"+selectedColor})),picker_color_close()}function picker_color_cancel(){picker_color_close()}function picker_color_select(e){var a=!!e.data||!1;$(this).hasClass("selected")||($(this).parent().find(".selected").removeClass("selected"),selectedColor=$(this).attr("data-value"),$(this).addClass("selected")),a&&picker_color_save()}function picker_icon_open(){iconInput=$(this).parent().find("input"),actualIcon=iconInput.val();var e=$(".picker-icon").clone(!0);actualIcon&&e.find('[data-value="'+actualIcon+'"]').addClass("selected"),$("#panel-"+PANEL).find(".picker").append(e).addClass("open")}function picker_icon_close(){iconInput="",actualIcon="",selectedIcon="",$("#panel-"+PANEL).find(".picker").html("").removeClass("open")}function picker_icon_save(){selectedIcon&&selectedIcon!=actualIcon&&(iconInput.val(selectedIcon),iconInput.parent().find(".preview i").removeClass().addClass(selectedIcon)),picker_icon_close()}function picker_icon_cancel(){picker_icon_close()}function picker_icon_search(){var e=$.trim($(this).val()),a=$("#panel-"+PANEL).find(".icon-grid");""!=e?(a.find("span").hide(),a.find("div").each(function(a,t){var i=$(this).attr("data-value"),n=new RegExp(e,"i");i.match(n)?$(this).show():$(this).hide()})):(a.find(".span").show(),a.find(".div").show())}function picker_icon_search_reset(){$("#panel-"+PANEL).find(".action-icon-search").val("").trigger("keyup")}function picker_icon_select(e){var a=!!e.data||!1;$(this).hasClass("selected")||($(this).parent().find(".selected").removeClass("selected"),selectedIcon=$(this).attr("data-value"),$(this).addClass("selected")),a&&picker_icon_save()}function picker_action_open(){inputMacro=$(this).parent().find("input"),actualMacro=inputMacro.val();var e=$(".picker-action").clone(!0);actualMacro&&e.find('[data-value="'+actualMacro+'"]').addClass("selected"),$("#panel-"+PANEL).find(".picker").append(e).addClass("open")}function picker_action_close(){inputMacro="",selectedMacroUIID="",actualmacro="",$("#panel-"+PANEL).find(".picker").html("").removeClass("open")}function picker_action_save(){selectedMacroUIID&&selectedMacroUIID!=actualmacro&&(inputMacro.val(selectedMacroUIID),inputMacro.parent().find(".preview").html(selectedMacroName)),picker_action_close()}function picker_action_cancel(){inputMacro="",selectedMacroName="",selectedMacroUIID="",actualmacro="",picker_action_close()}function picker_action_search(){var e=$.trim($(this).val()),a=$("#panel-"+PANEL).find(".macro-list");""!=e?(a.find(".group").hide(),a.find(".macro").each(function(a,t){var i=$(this).html(),n=new RegExp(e,"i");i.match(n)?$(this).show():$(this).hide()})):(a.find(".group").show(),a.find(".macro").show())}function picker_action_search_reset(){$("#panel-"+PANEL).find(".action-action-search").val("").trigger("keyup")}function picker_action_reload(){var e=$("#panel"+PANEL).find(".macro-list").find(".selected").attr("data-value");$(".action-macro-list-refresh").addClass("loading"),$.ajax({data:{action:"macrolist"},success:function(a){setTimeout(function(){$(".picker-action").find(".macro-list").html(a),e&&$("#panel-"+PANEL).find(".macro-list").find('[data-value="'+e+'"]').addClass("selected"),$(".action-macro-list-refresh").removeClass("loading")},500)}})}function picker_action_select_macro(e){var a=!!e.data||!1;$(this).hasClass("selected")||($(this).parent().find(".selected").removeClass("selected"),selectedMacroUIID=$(this).attr("data-value"),selectedMacroName=$(this).html(),$(this).addClass("selected")),a&&picker_action_save()}function kmr_init(){document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1),$("#top-menu-panel-handler").css({top:margeH,right:margeW}),$("#top-menu-panel").css({marginLeft:0-(250+margeW-1)}),$("#main-menu").css({top:margeH+40+6}),activate_mode_run(),$.ajaxSetup({url:ajaxurl,dataType:"json",type:"POST"}),$.ajax({data:{action:"getdatas"},success:function(e){BOARDS=TAFFY(e.boards),WIDGETS=TAFFY(e.widgets),build()}}),picker_action_reload(),activate_check_mac_infos()}function build(){var e=BOARDS().get(),a;e.length&&(console.log(e),e.forEach(function(e){build_board(e),board_manager_new_board(e,!1),last=e.board_id})),activate_board(last);var e=WIDGETS().get();e.length&&(console.log(e),e.forEach(function(e){build_widget(e,!1)}))}!function($){function e(){$(".grid-unit.on").removeClass("on"),$(".grid-unit").filter(function(e){var o=parseInt($(this).attr("data-col"),10),d=parseInt($(this).attr("data-row"),10);return o>=a&&o<=i&&d>=t&&d<=n||!1}).addClass("on")}var a="",t="",i="",n="",o=!1;$("#boards").on("mousedown touchstart",".grid-unit",function(e){a=parseInt($(this).attr("data-col"),10),t=parseInt($(this).attr("data-row"),10),o=!0}),$("#boards").on("mouseenter touchmove",".grid-unit",function(a){a.preventDefault();var t=document.elementFromPoint(a.pageX,a.pageY);return o&&(i=parseInt($(t).attr("data-col"),10),n=parseInt($(t).attr("data-row"),10),e()),!1}),$("#boards").on("mouseup touchend",function(){o=!1,$(".grid-unit.on").length>3?init_new_widget(a,t,i,n):$(".grid-unit.on").removeClass("on")})}(jQuery);var checkMacInfosTimeout;$("#top-menu-panel-handler").on("click",menu_toggle),$("#action-edit").on("click",{mode:"edit"},toggle_mode),$("#action-run").on("click",{mode:"run"},toggle_mode),$("#action-dynamic-board-switch-toggle").on("click",toggle_auto_switch_boards),$("#action-new-board").on("click",new_board),$("#action-edit-board").on("click",edit_board),$("#action-delete-board").on("touchend",init_delete_board_current),$("#boards-manager").on("click",".item",board_manager_activate_board);var board2Delete;$("#boards").on("taphold",".widget",focus_widget),$("#boards").on("taphold",".selected",deselect_widget),$("#boards").on("tap",".selected",edit_widget),$("#boards").on("tap",".resizer",function(e){e.stopPropagation(),e.preventDefault()}),$("#boards").on("tap",".widget",do_widget_macro),$("#action-panel-widget-cancel").on("click",panel_widget_cancel),$("#action-panel-widget-save").on("click",panel_save_widget),$("#action-widget-delete").on("click",panel_delete_widget),$('input[name="widget_view"]').on("click",widget_view_option),$(".action-cancel-board-delete").on("click",cancel_delete_board),$(".action-confirm-board-delete").on("click",confirm_delete_board),$("#action-panel-board-cancel").on("click",panel_board_cancel),$("#action-panel-board-save").on("click",panel_board_save),$("#action-listen-app").on("click",toggle_listen_app),$("#action-listen-path").on("click",toggle_listen_path),$(".input-color").on("touchend",".preview",picker_color_open),$(".action-color-picker-back").on("touchend",picker_color_save),$(".action-color-picker-cancel").on("touchend",picker_color_cancel),$(".color-grid").on("touchend","div",picker_color_select),$(".color-grid").on("doubletap","div",{},picker_color_select);var colorInput,actualColor,selectedColor;$(".input-icon").on("touchend",".preview",picker_icon_open),$(".action-icon-picker-back").on("touchend",picker_icon_save),$(".action-icon-picker-cancel").on("touchend",picker_icon_cancel),$(".action-icon-search").on("keypress",picker_icon_search),$(".action-icon-search-reset").on("touchend",picker_icon_search_reset),$(".icon-grid").on("touchend","div",picker_icon_select),$(".icon-grid").on("doubletap","div",{},picker_icon_select);var iconInput,actualIcon,selectedIcon;$(".input-action").on("touchend",".preview",picker_action_open),$(".action-action-picker-back").on("touchend",picker_action_save),$(".action-action-picker-cancel").on("touchend",picker_action_cancel),$(".action-action-search").on("keyup",picker_action_search),$(".action-action-search-reset").on("touchend",picker_action_search_reset),$(".action-macro-list-refresh").on("touchend",picker_action_reload),$(".macro-list").on("touchend","div",picker_action_select_macro),$(".macro-list").on("doubletap","div",{},picker_action_select_macro);var inputMacro,actualmacro,selectedMacroUIID,selectedMacroName,BOARDS,WIDGETS,MODE,AUTOSWITCH=!1,PANEL,ListenDelay=1e3,ListenApp=!1,ListenPath=!1,margeMin=20,wH=$(window).height(),nItemH=Math.floor((wH-2*margeMin)/20),margesH=wH-20*nItemH,margeH=margesH/2,wW=$(window).width(),nItemW=Math.floor((wW-2*margeMin)/20),margesW=wW-20*nItemW,margeW=margesW/2;$.ajaxSetup({url:ajaxurl,dataType:"json",type:"POST"}),kmr_init(),$('input[type="text"],textarea').on("touchstart",function(e){e.stopPropagation(),e.preventDefault();var a=$(this),t=$(this).parents(".content"),i=$(this).offset().top+t.scrollTop()-62;t.animate({scrollTop:i},300,function(){a.focus()})});